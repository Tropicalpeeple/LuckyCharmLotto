(this["webpackJsonpalgorand-wallet-walletconnect-redux"]=this["webpackJsonpalgorand-wallet-walletconnect-redux"]||[]).push([[0],{232:function(e,n,t){},259:function(e,n,t){},277:function(e,n){},279:function(e,n){},290:function(e,n){},292:function(e,n){},319:function(e,n){},320:function(e,n){},325:function(e,n){},327:function(e,n){},334:function(e,n){},336:function(e,n){},354:function(e,n){},435:function(e,n,t){"use strict";t.r(n);var c=t(0),a=t.n(c),r=t(31),s=t.n(r),o=t(66),i=(t(232),t(2)),l=t.n(i),u=t(5),d=t(450),f=t(69),j=t(78),b=t.n(j),h=(t(259),t(451));function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return"".concat(e.slice(0,n),"...").concat(e.slice(-n))}function g(e,n){var t=BigInt("1"+"0".repeat(n)),c=e%t;return(e/t).toString()+"."+c.toString().padStart(n,"0")}var m,O=t(38),v=t(45),x=t(77),w=t(83),C=t.n(w);!function(e){e.MainNet="mainnet",e.TestNet="testnet"}(m||(m={}));var y=new C.a.Algodv2("","https://mainnet-api.algonode.cloud",""),N=new C.a.Algodv2("","https://testnet-api.algonode.cloud","");function k(e){switch(e){case m.MainNet:return y;case m.TestNet:return N;default:throw new Error("Unknown chain type: ".concat(e))}}function A(e,n){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(l.a.mark((function e(n,t){var c,a,r,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=k(n),e.next=3,c.accountInformation(t).setIntDecoding(C.a.IntDecoding.BIGINT).do();case 3:return a=e.sent,r=a.amount.toString(),s=a.assets,(o=s.map((function(e){var n=e["asset-id"],t=e.amount,c=e["is-frozen"];return{id:Number(n),amount:t.toString(),frozen:c,decimals:0,creator:""}}))).sort((function(e,n){return e.id-n.id})),e.next=10,Promise.all(o.map((function(e,n){return new Promise((function(t){setTimeout(Object(u.a)(l.a.mark((function n(){var a,r;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c.getAssetByID(e.id).do();case 3:a=n.sent,r=a.params,e.name=r.name,e.unitName=r["unit-name"],e.url=r.url,e.decimals=r.decimals,e.creator=r.creator,n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.error("asset:",e.id,n.t0.message);case 15:t();case 16:case"end":return n.stop()}}),n,null,[[0,12]])}))),25*n)}))})));case 10:return o.unshift({id:0,amount:r,creator:"",frozen:!1,decimals:6,name:"Algo",unitName:"Algo"}),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I={accounts:[],address:"",assets:[{id:0,amount:"0",creator:"",frozen:!1,decimals:6,name:"Algo",unitName:"Algo"}],chain:m.TestNet,fetching:!1},M=Object(v.b)("walletConnect/getAccountAssets",function(){var e=Object(u.a)(l.a.mark((function e(n){var t,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.chain,c=n.address,e.next=3,A(t,c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),T=Object(v.c)({name:"walletConnect",initialState:I,reducers:{switchChain:function(e,n){e.chain=n.payload},reset:function(e){return Object(O.a)(Object(O.a)({},I),{},{chain:e.chain})},onSessionUpdate:function(e,n){e.accounts=n.payload,e.address=n.payload[0]}},extraReducers:function(e){e.addCase(M.fulfilled,(function(e,n){e.fetching=!1,e.assets=n.payload})),e.addCase(M.pending,(function(e){e.fetching=!0}))}}),D=Object(x.a)((function(e){return e.walletConnect.assets}),(function(e){return e.map((function(e){return Object(O.a)(Object(O.a)({},e),{},{amount:BigInt(e.amount)})}))})),B=T.actions,E=B.switchChain,P=B.reset,F=B.onSessionUpdate,z=T.reducer,_=Object(v.c)({name:"application",initialState:{isModalOpen:!1},reducers:{setIsModalOpen:function(e,n){e.isModalOpen=n.payload}}}),U=_.actions.setIsModalOpen,J=_.reducer,L=function(){return Object(o.b)()},W=o.c,q=t(221),G={bridge:"https://bridge.walletconnect.org",qrcodeModal:b.a},R=new q.a(G),H=Object(c.createContext)(R),K=t(4),Q=function(){var e=W((function(e){return e.walletConnect})),n=e.fetching,t=e.address,a=e.chain,r=W(D),s=L(),o=Object(c.useContext)(H);Object(c.useEffect)((function(){if(o.connected){var e=o.accounts;s(F(e))}return console.log("%cin subscribeToEvents","background: yellow"),o.on("connect",(function(e,n){if(console.log("%cOn connect","background: yellow"),e)throw e;var t=n.params[0].accounts;s(F(t)),s(U(!1))})),o.on("session_update",(function(e,n){if(console.log("%cOn session_update","background: yellow"),e)throw e;var t=n.params[0].accounts;s(F(t))})),o.on("disconnect",(function(e,n){if(console.log("%cOn disconnect","background: yellow"),e)throw e;s(P())})),function(){console.log("%cin unsubscribeFromEvents","background: yellow"),o.off("connect"),o.off("session_update"),o.off("disconnect")}}),[s,o]),Object(c.useEffect)((function(){(null===t||void 0===t?void 0:t.length)>0&&(console.log("chain: ",a),s(M({chain:a,address:t})))}),[s,t,a]);var i=r.find((function(e){return 0===e.id}));return Object(K.jsx)("div",{className:"site-layout-background site-header",children:Object(K.jsxs)("div",{className:"site-header-inner",children:[Object(K.jsxs)("div",{children:[Object(K.jsx)("span",{children:"Connected to "}),Object(K.jsxs)(h.a,{value:a,onChange:function(e){return s(E(e.target.value))},children:[Object(K.jsx)("option",{value:m.TestNet,children:"Testnet"}),Object(K.jsx)("option",{value:m.MainNet,children:"Mainnet"})]})]}),t?Object(K.jsxs)("div",{className:"header-address-info",children:[!n&&Object(K.jsxs)("span",{children:[g(i.amount,i.decimals)," ",i.unitName||"units"]}),Object(K.jsx)("span",{className:"header-account",children:p(t)}),Object(K.jsx)(f.a,{className:"disconnect-button",onClick:function(){return o.killSession().catch((function(e){return console.error(e.message)}))},children:"Disconnect"})]}):Object(K.jsx)(f.a,{onClick:function(){return s(U(!0))},children:"Connect Wallet"})]})})},V=function(e){var n=e.src,t=e.fallback;return Object(K.jsx)("img",Object(O.a)(Object(O.a)({},e),{},{src:n,alt:"icon",className:"icon",onError:function(e){t&&(e.target.src=t)}}))};V.defaultProps={src:null,fallback:"",size:20};var X=V,Y=function(e){var n="https://algoexplorer.io/images/assets/big/light/".concat(e.assetID,".png");return Object(K.jsx)(X,{src:n})};Y.defaultProps={assetID:0};var Z=Y,$=t.p+"static/media/algo.ecbc85e5.svg",ee=function(e){var n=e.asset;return Object(K.jsxs)("div",{className:"asset-row",children:[Object(K.jsxs)("div",{className:"asset-info",children:[0===n.id?Object(K.jsx)(X,{src:$}):Object(K.jsx)(Z,{assetID:n.id}),Object(K.jsx)("span",{children:n.name})]}),Object(K.jsx)("div",{children:Object(K.jsx)("div",{children:"".concat(g(n.amount,n.decimals)," ").concat(n.unitName||"units")})})]})},ne=function(e){var n=e.assets,t=n.find((function(e){return 0===e.id})),c=n.filter((function(e){return 0!==e.id}));return Object(K.jsxs)("div",{children:[Object(K.jsx)("h2",{children:"Account Balance"}),Object(K.jsx)(ee,{asset:t},t.id),c.map((function(e){return Object(K.jsx)(ee,{asset:e},e.id)}))]})},te=function(){return Object(K.jsx)("div",{className:"loading-icon",children:Object(K.jsx)("span",{})})},ce=function(){var e=W((function(e){return e.walletConnect.fetching})),n=W(D);return Object(K.jsx)("div",{className:"site-body",children:Object(K.jsx)("div",{className:"site-body-inner",children:e?Object(K.jsx)(te,{}):Object(K.jsx)(ne,{assets:n})})})},ae=t.p+"static/media/algorandwallet.37675b59.svg",re=function(){var e=W((function(e){return e.application})).isModalOpen,n=L(),t=Object(c.useContext)(H),a=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.connected){e.next=2;break}return e.abrupt("return");case 2:if(!t.pending){e.next=4;break}return e.abrupt("return",b.a.open(t.uri,null));case 4:return e.next=6,t.createSession();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(K.jsx)("div",{children:Object(K.jsxs)("div",{className:"site-layout",children:[Object(K.jsx)(Q,{}),Object(K.jsx)(ce,{}),Object(K.jsxs)("div",{className:"footer",children:["Made with \ud83d\udc96 by"," ",Object(K.jsx)("a",{href:"https://github.com/fionnachan",target:"_blank",rel:"noreferrer",children:"@fionnachan"})]}),Object(K.jsx)(d.a,{isShown:e,title:"Connect to a wallet",hasFooter:!1,onCloseComplete:function(){return n(U(!1))},children:Object(K.jsxs)(f.a,{className:"wallet-button",onClick:a,children:[Object(K.jsx)("img",{className:"wallet-icon",src:ae,alt:"Algorand wallet"}),Object(K.jsx)("span",{children:"Algorand Wallet"})]})})]})})},se=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,452)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,r=n.getLCP,s=n.getTTFB;t(e),c(e),a(e),r(e),s(e)}))},oe=function(e){var n=e.getState;return function(e){return function(t){"walletConnect/switchChain"===t.type&&console.log("switch chain: ",t.payload),"walletConnect/getAccountAssets/pending"===t.type&&console.log("loading assets..."),"walletConnect/getAccountAssets/fulfilled"===t.type&&console.log("assets sucessfully loaded"),"walletConnect/getAccountAssets/rejected"===t.type&&console.error(t.error.message);var c=e(t);return"walletConnect/reset"===t.type&&console.log("reset state",n().walletConnect),c}}},ie=Object(v.a)({reducer:{walletConnect:z,application:J},preloadedState:{},middleware:function(e){return e().concat(oe)}});s.a.render(Object(K.jsx)(a.a.StrictMode,{children:Object(K.jsx)(o.a,{store:ie,children:Object(K.jsx)(H.Provider,{value:R,children:Object(K.jsx)(re,{})})})}),document.getElementById("root")),se()}},[[435,1,2]]]);
//# sourceMappingURL=main.4154750f.chunk.js.map